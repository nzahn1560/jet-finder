<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Aircraft Scoring System Demo - Jet Finder</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #f5f7fa;
            color: #2d3748;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 12px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            margin: 0;
            font-size: 2.5em;
            font-weight: 300;
        }

        .header p {
            margin: 10px 0 0 0;
            opacity: 0.9;
            font-size: 1.1em;
        }

        .content {
            padding: 30px;
        }

        .methodology {
            background: #f8fafc;
            border-left: 4px solid #667eea;
            padding: 20px;
            margin: 20px 0;
            border-radius: 0 8px 8px 0;
        }

        .methodology h3 {
            margin-top: 0;
            color: #667eea;
        }

        .step {
            margin: 10px 0;
            padding: 8px 0;
            border-bottom: 1px solid #e2e8f0;
        }

        .step:last-child {
            border-bottom: none;
        }

        .controls {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin: 30px 0;
        }

        .priority-section,
        .filters-section {
            background: #f8fafc;
            padding: 20px;
            border-radius: 8px;
            border: 1px solid #e2e8f0;
        }

        .priority-section h3,
        .filters-section h3 {
            margin-top: 0;
            color: #4a5568;
        }

        .priority-item,
        .filter-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin: 15px 0;
        }

        .slider {
            width: 150px;
        }

        .weight-display {
            font-weight: bold;
            color: #667eea;
            min-width: 40px;
            text-align: right;
        }

        .calculate-btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 8px;
            font-size: 1.1em;
            cursor: pointer;
            width: 100%;
            margin: 20px 0;
            transition: transform 0.2s;
        }

        .calculate-btn:hover {
            transform: translateY(-2px);
        }

        .results {
            margin-top: 30px;
        }

        .aircraft-card {
            background: white;
            border: 1px solid #e2e8f0;
            border-radius: 8px;
            padding: 20px;
            margin: 15px 0;
            transition: transform 0.2s, box-shadow 0.2s;
        }

        .aircraft-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
        }

        .aircraft-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .aircraft-name {
            font-size: 1.3em;
            font-weight: bold;
            color: #2d3748;
        }

        .final-score {
            font-size: 2em;
            font-weight: bold;
            color: #667eea;
        }

        .score-breakdown {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin: 15px 0;
        }

        .score-item {
            text-align: center;
            padding: 10px;
            background: #f8fafc;
            border-radius: 6px;
        }

        .score-label {
            font-size: 0.9em;
            color: #718096;
            margin-bottom: 5px;
        }

        .score-value {
            font-size: 1.2em;
            font-weight: bold;
            color: #4a5568;
        }

        .aircraft-specs {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 10px;
            margin-top: 15px;
            padding-top: 15px;
            border-top: 1px solid #e2e8f0;
        }

        .spec-item {
            text-align: center;
        }

        .spec-label {
            font-size: 0.8em;
            color: #718096;
        }

        .spec-value {
            font-weight: bold;
            color: #2d3748;
        }

        .loading {
            text-align: center;
            padding: 40px;
            color: #718096;
        }

        .error {
            background: #fed7d7;
            color: #c53030;
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
        }
    </style>
</head>

<body>
    <div class="container">
        <div class="header">
            <h1>Aircraft Scoring System</h1>
            <p>Advanced recommendation engine combining spreadsheet metrics with your priorities</p>
        </div>

        <div class="content">
            <div class="methodology">
                <h3>üìä Scoring Methodology</h3>
                <div class="step"><strong>Step 1:</strong> Calculate spreadsheet score (average of speed/$, range/$,
                    performance/$, efficiency/$, all-around/$)</div>
                <div class="step"><strong>Step 2:</strong> Calculate priority score (your weighted preferences as
                    percentages)</div>
                <div class="step"><strong>Step 3:</strong> Average spreadsheet and priority scores</div>
                <div class="step"><strong>Step 4:</strong> Average result with all-around/$ score</div>
                <div class="step"><strong>Formula:</strong>
                    <code>((spreadsheet_avg + priority_avg) / 2 + all_around_%) / 2</code></div>
            </div>

            <div class="controls">
                <div class="priority-section">
                    <h3>üéØ Your Priorities</h3>
                    <div class="priority-item">
                        <label>Price (lower is better):</label>
                        <input type="range" min="0" max="50" value="30" class="slider" id="price-weight">
                        <span class="weight-display" id="price-display">30%</span>
                    </div>
                    <div class="priority-item">
                        <label>Range:</label>
                        <input type="range" min="0" max="50" value="25" class="slider" id="range-weight">
                        <span class="weight-display" id="range-display">25%</span>
                    </div>
                    <div class="priority-item">
                        <label>Speed:</label>
                        <input type="range" min="0" max="50" value="20" class="slider" id="speed-weight">
                        <span class="weight-display" id="speed-display">20%</span>
                    </div>
                    <div class="priority-item">
                        <label>Passengers:</label>
                        <input type="range" min="0" max="50" value="15" class="slider" id="passengers-weight">
                        <span class="weight-display" id="passengers-display">15%</span>
                    </div>
                    <div class="priority-item">
                        <label>Operating Cost (lower is better):</label>
                        <input type="range" min="0" max="50" value="10" class="slider" id="cost-weight">
                        <span class="weight-display" id="cost-display">10%</span>
                    </div>
                </div>

                <div class="filters-section">
                    <h3>üéõÔ∏è Mission Requirements</h3>
                    <div class="filter-item">
                        <label>Budget (millions):</label>
                        <input type="number" value="50" id="budget" style="width: 80px;">
                    </div>
                    <div class="filter-item">
                        <label>Range Requirement (NM):</label>
                        <input type="number" value="3000" id="range-req" style="width: 80px;">
                    </div>
                    <div class="filter-item">
                        <label>Min Passengers:</label>
                        <input type="number" value="8" id="passengers-req" style="width: 80px;">
                    </div>
                    <div class="filter-item">
                        <label>Mission Type:</label>
                        <select id="mission-type" style="width: 120px;">
                            <option value="business">Business</option>
                            <option value="personal">Personal</option>
                            <option value="charter">Charter</option>
                        </select>
                    </div>
                </div>
            </div>

            <button class="calculate-btn" onclick="calculateScores()">üöÄ Calculate Aircraft Scores</button>

            <div id="results" class="results"></div>
        </div>
    </div>

    <script>
        // Update weight displays
        const sliders = ['price', 'range', 'speed', 'passengers', 'cost'];
        sliders.forEach(slider => {
            const input = document.getElementById(`${slider}-weight`);
            const display = document.getElementById(`${slider}-display`);

            input.addEventListener('input', function () {
                display.textContent = this.value + '%';
            });
        });

        async function calculateScores() {
            const resultsDiv = document.getElementById('results');
            resultsDiv.innerHTML = '<div class="loading">üîÑ Calculating aircraft scores...</div>';

            // Gather priorities
            const priorities = {
                price: parseInt(document.getElementById('price-weight').value),
                range: parseInt(document.getElementById('range-weight').value),
                speed: parseInt(document.getElementById('speed-weight').value),
                passengers: parseInt(document.getElementById('passengers-weight').value),
                total_hourly_cost: parseInt(document.getElementById('cost-weight').value)
            };

            // Gather user inputs
            const user_inputs = {
                budget: parseInt(document.getElementById('budget').value) * 1000000,
                range_requirement: parseInt(document.getElementById('range-req').value),
                passengers: parseInt(document.getElementById('passengers-req').value),
                mission_type: document.getElementById('mission-type').value
            };

            try {
                const response = await fetch('/api/aircraft-scoring', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({ priorities, user_inputs })
                });

                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }

                const data = await response.json();
                displayResults(data);

            } catch (error) {
                resultsDiv.innerHTML = `<div class="error">‚ùå Error calculating scores: ${error.message}</div>`;
            }
        }

        function displayResults(data) {
            const resultsDiv = document.getElementById('results');
            const rankings = data.aircraft_rankings.slice(0, 10); // Top 10

            let html = `
                <h3>üèÜ Top ${rankings.length} Aircraft Recommendations</h3>
                <p>Evaluated ${data.total_aircraft_evaluated} aircraft using your priorities</p>
            `;

            rankings.forEach((item, index) => {
                const aircraft = item.aircraft;
                const rank = index + 1;

                html += `
                    <div class="aircraft-card">
                        <div class="aircraft-header">
                            <div>
                                <div class="aircraft-name">${rank}. ${aircraft.aircraft_name || 'Unknown'}</div>
                                <div style="color: #718096;">${aircraft.manufacturer || 'Unknown'}</div>
                            </div>
                            <div class="final-score">${item.final_recommendation_score.toFixed(1)}%</div>
                        </div>
                        
                        <div class="score-breakdown">
                            <div class="score-item">
                                <div class="score-label">Spreadsheet Score</div>
                                <div class="score-value">${item.spreadsheet_score.toFixed(1)}%</div>
                            </div>
                            <div class="score-item">
                                <div class="score-label">Priority Score</div>
                                <div class="score-value">${item.priority_score.toFixed(1)}%</div>
                            </div>
                            <div class="score-item">
                                <div class="score-label">Combined Score</div>
                                <div class="score-value">${item.combined_score.toFixed(1)}%</div>
                            </div>
                            <div class="score-item">
                                <div class="score-label">All-Around/$</div>
                                <div class="score-value">${item.all_around_percentage.toFixed(1)}%</div>
                            </div>
                        </div>
                        
                        <div class="aircraft-specs">
                            <div class="spec-item">
                                <div class="spec-label">Price</div>
                                <div class="spec-value">$${(aircraft.price || 0).toLocaleString()}</div>
                            </div>
                            <div class="spec-item">
                                <div class="spec-label">Range</div>
                                <div class="spec-value">${aircraft.range || 0} NM</div>
                            </div>
                            <div class="spec-item">
                                <div class="spec-label">Speed</div>
                                <div class="spec-value">${aircraft.speed || 0} KTS</div>
                            </div>
                            <div class="spec-item">
                                <div class="spec-label">Passengers</div>
                                <div class="spec-value">${aircraft.passengers || 0}</div>
                            </div>
                            <div class="spec-item">
                                <div class="spec-label">All-Around/$</div>
                                <div class="spec-value">${(aircraft.best_all_around_dollar || 0).toFixed(3)}</div>
                            </div>
                        </div>
                    </div>
                `;
            });

            resultsDiv.innerHTML = html;
        }

        // Calculate initial scores on page load
        window.addEventListener('load', function () {
            setTimeout(calculateScores, 500);
        });
    </script>
</body>

</html>